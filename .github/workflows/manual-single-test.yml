name: Manual Single Test

on:
  workflow_dispatch:
    inputs:
      test_name:
        description: "Name of the test to run"
        required: true
        type: string

env:
  CARGO_TERM_COLOR: always
  RUST_BACKTRACE: 1
  CARGO_REGISTRIES_CRATES_IO_PROTOCOL: sparse

jobs:
  single-test:
    name: Run selected test
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Rust nightly
        uses: dtolnay/rust-toolchain@nightly

      - name: Cargo build (release)
        run: cargo +nightly build --release

      - name: Run selected test
        env:
          TEST_NAME: ${{ inputs.test_name }}
        run: |
          echo "Running test: $TEST_NAME"
          cargo +nightly test --release "$TEST_NAME"
